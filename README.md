# ALL-PET: A Low-resource and Low-shot PET Foundation Model in Projection Domain

Author: Bin Huang, Kang Chen, Bingxuan Li, Huafeng Liu, Qiegen Liu   

Building large-scale foundation model for PET imaging is hindered by limited access to labeled data and insufficient computational resources. To overcome data scarcity and efficiency limitations, we propose ALL-PET, a low-resource, low-shot PET foundation model operating directly in the projection domain. ALL-PET leverages a latent diffusion model (LDM) with three key innovations. First, we design a Radon mask augmentation strategy (RMAS) that generates over 200,000 structurally diverse training samples by projecting randomized image-domain masks into sinogram space, significantly improving generalization with minimal data. This is extended by a dynamic multi-mask (DMM) mechanism that varies mask quantity and distribution, enhancing data diversity without added model complexity. Second, we implement positive/negative mask constraints to embed strict geometric consistency, reducing parameter burden while preserving generation quality. Third, we introduce transparent medical attention (TMA), a parameter-free, geometry-driven mechanism that enhances lesion-related regions in raw projection data. Lesion-focused attention maps are derived from coarse segmentation, covering both hypermetabolic and hypometabolic areas, and projected into sinogram space for physically consistent guidance. The system supports clinician-defined ROI adjustments, ensuring flexible, interpretable, and task-adaptive emphasis aligned with PET acquisition physics. Experimental results show ALL-PET achieves high-quality sinogram generation using only 500 samples, with performance comparable to models trained on larger datasets. ALL-PET generalizes across tasks including low-dose reconstruction, attenuation correction, delayed-frame prediction, and tracer separation, operating efficiently with memory use under 24GB.

## Overview of the ALL-PET foundation model and traininginference pipeline.
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.%201.%20Overview%20of%20the%20ALL-PET%20foundation%20model%20and%20traininginference%20pipeline..png)
RMAS and DMM are used for PET sinogram synthesis while TMA is used for downstream tasks. By incorporating DDPM/DDIM/DDBM into the latent diffusion, ALL-PET can be utilized as supervised and unsupervised model. Prompt is used for generating different tracer or anatomical regions and controllable parameters can output specified size of the sinograms.

## Synthetic projection-domain data generated by ALL-PET
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.%202.%20Synthetic%20projection-domain%20data%20generated%20by%20ALL-PET%20a.png)
Synthetic projection-domain data generated by ALL-PET and their corresponding reconstructed PET images, shown for multiple radiotracers e.g., 18F-FDG, 18F-DOPA, 68Ga-PSMA and different anatomical regions e.g., Brain, Trunk, Chest, Abdomen.

## Task-specified paired synthetic data generated by ALL-PET
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.%203.%20Task-specified%20paired%20synthetic%20data%20generated%20by%20ALL-PET.png)
 Task-specified paired synthetic data generated by ALL-PET, showing projection-domain data and their corresponding reconstructed PET images for five representative downstream tasks e.g., low-dose and normal-dose data, before and after attenuation correction, first scan and delayed scan synthesis, dual-tracer separation and tracer conversion.

## Visual juxtaposition of generated outputs from each method
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.4.visual%20juxtaposition%20of%20generated%20outputs%20from%20each%20method%2C.png)
 visual juxtaposition of generated outputs from each method, with red boxes denoting regions enlarged for detailed inspection

## Generation of PET Projection Domain

<table>
 # Generation of PET_brain images
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/4_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/5_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/6_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/7_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/8_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/11_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/16_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/20_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/23_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/24_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
  </tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/31_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/33_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/35_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/37_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/39_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
  </tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/41_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/48_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/50_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/56_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/39_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
 
<table>    
  <tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/4.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/5.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/6.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/7.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/8.png" alt="GIF 3" style="width:180px;height:180px;"></td>
  </tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/11.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/16.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/20.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/23.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/24.png" alt="GIF 3" style="width:180px;height:180px;"></td>
  </tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/31.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/33.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/35.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/37.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/39.png" alt="GIF 3" style="width:180px;height:180px;"></td>
  </tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/41.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/48.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/50.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/56.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/39.png" alt="GIF 3" style="width:180px;height:180px;"></td>

<table>
 # Generation of PET_body images
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/14_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/16_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/17_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/19_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/20_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/22_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/23_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/27_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/34_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/40_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/42_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/49_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/51_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/52_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/53_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/56_transition.gif" alt="GIF 1" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/59_transition.gif" alt="GIF 2" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/60_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/61_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/gif/git_body/66_transition.gif" alt="GIF 3" style="width:180px;height:180px;"></td>

<table>    
  <tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/14.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/16.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/17.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/19.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/20.png" alt="GIF 3" style="width:180px;height:180px;"></td>
  <tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/22.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/23.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/27.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/34.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/40.png" alt="GIF 3" style="width:180px;height:180px;"></td>
     <tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/42.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/49.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/51.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/52.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/53.png" alt="GIF 3" style="width:180px;height:180px;"></td>
     <tr>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/56.png" alt="GIF 1" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/59.png" alt="GIF 2" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/60.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/61.png" alt="GIF 3" style="width:180px;height:180px;"></td>
   <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/img_png/img_png/66.png" alt="GIF 3" style="width:180px;height:180px;"></td>

<table>

  <tr>


## Other Related Projects
* Raysolution_PET_Data [<font size=5>**[Data]**</font>](https://github.com/yqx7150/Raysolution_PET_Data)

* Diffusion Transformer Model with Compact Prior for Low-dose PET Reconstruction [<font size=5>**[Paper]**</font>](https://arxiv.org/abs/2407.00944)     [<font size=5>**[Code]**</font>](https://github.com/yqx7150/dtm)

* PET Tracer Separation using Conditional Diffusion Transformer with Multi-latent Space Learning [<font size=5>**[Paper]**</font>](https://arxiv.org/abs/2506.16934#:~:text=In%20this%20study%2C%20a%20multi-latent%20space%20guided%20texture,model%20%28MS-CDT%29%20is%20proposed%20for%20PET%20tracer%20separation.)

* Diffusion Transformer Meets Random Masks: An Advanced PET Reconstruction Framework [<font size=5>**[Paper]**</font>](https://arxiv.org/abs/2503.08339)  [<font size=5>**[Code]**</font>](https://github.com/yqx7150/DREAM)

* Synthetic CT Generation via Variant Invertible Network for Brain PET Attenuation Correction [<font size=5>**[Paper]**</font>](https://ieeexplore.ieee.org/document/10666843) [<font size=5>**[Code]**</font>](https://github.com/yqx7150/PET_AC_sCT)

 * Spatial-Temporal Guided Diffusion Transformer Probabilistic Model for Delayed Scan PET Image Prediction [<font size=5>**[Paper]**</font>](https://ieeexplore.ieee.org/abstract/document/10980366)   [<font size=5>**[Code]**</font>](https://github.com/yqx7150/st-DTPM)      
