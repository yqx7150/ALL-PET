# ALL-PET
Building large-scale foundation model for PET imaging is hindered by limited access to labeled data and insufficient computational resources. To overcome data scarcity and efficiency limitations, we propose ALL-PET, a low-resource, low-shot PET foundation model operating directly in the projection domain. ALL-PET leverages a latent diffusion model (LDM) with three key innovations. First, we design a Radon mask augmentation strategy (RMAS) that generates over 200,000 structurally diverse training samples by projecting randomized image-domain masks into sinogram space, significantly improving generalization with minimal data. This is extended by a dynamic multi-mask (DMM) mechanism that varies mask quantity and distribution, enhancing data diversity without added model complexity. Second, we implement positive/negative mask constraints to embed strict geometric consistency, reducing parameter burden while preserving generation quality. Third, we introduce transparent medical attention (TMA), a parameter-free, geometry-driven mechanism that enhances lesion-related regions in raw projection data. Lesion-focused attention maps are derived from coarse segmentation, covering both hypermetabolic and hypometabolic areas, and projected into sinogram space for physically consistent guidance. The system supports clinician-defined ROI adjustments, ensuring flexible, interpretable, and task-adaptive emphasis aligned with PET acquisition physics. Experimental results show ALL-PET achieves high-quality sinogram generation using only 500 samples, with performance comparable to models trained on larger datasets. ALL-PET generalizes across tasks including low-dose reconstruction, attenuation correction, delayed-frame prediction, and tracer separation, operating efficiently with memory use under 24GB.

## Overview of the ALL-PET foundation model and traininginference pipeline.
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.%201.%20Overview%20of%20the%20ALL-PET%20foundation%20model%20and%20traininginference%20pipeline..png)
RMAS and DMM are used for PET sinogram synthesis while TMA is used for downstream tasks. By incorporating DDPM/DDIM/DDBM into the latent diffusion, ALL-PET can be utilized as supervised and unsupervised model. Prompt is used for generating different tracer or anatomical regions and controllable parameters can output specified size of the sinograms.

## Synthetic projection-domain data generated by ALL-PET
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.%202.%20Synthetic%20projection-domain%20data%20generated%20by%20ALL-PET%20a.png)
Synthetic projection-domain data generated by ALL-PET and their corresponding reconstructed PET images, shown for multiple radiotracers e.g., 18F-FDG, 18F-DOPA, 68Ga-PSMA and different anatomical regions e.g., Brain, Trunk, Chest, Abdomen.

## Task-specified paired synthetic data generated by ALL-PET
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.%203.%20Task-specified%20paired%20synthetic%20data%20generated%20by%20ALL-PET.png)
 Task-specified paired synthetic data generated by ALL-PET, showing projection-domain data and their corresponding reconstructed PET images for five representative downstream tasks e.g., low-dose and normal-dose data, before and after attenuation correction, first scan and delayed scan synthesis, dual-tracer separation and tracer conversion.

## Visual juxtaposition of generated outputs from each method
![](https://github.com/yqx7150/ALL-PET/blob/main/Fig.4.visual%20juxtaposition%20of%20generated%20outputs%20from%20each%20method%2C.png)
 visual juxtaposition of generated outputs from each method, with red boxes denoting regions enlarged for detailed inspection

## Generation of PET Projection Domain

<table>
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_gif/gif%20(32).gif" alt="GIF 1" style="width:300px;height:300px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_gif/gif%20(33).gif" alt="GIF 2" style="width:300px;height:300px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_gif/gif%20(35).gif" alt="GIF 3" style="width:300px;height:300px;"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_gif/gif%20(36).gif" alt="GIF 4" style="width:300px;height:300px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_gif/gif%20(37).gif" alt="GIF 5" style="width:300px;height:300px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_gif/gif%20(38).gif" alt="GIF 6" style="width:300px;height:300px;"></td>
  </tr>
</table>

## Generation of PET dominated by the projection domain
<table>  
  <tr>
    # Generation of PET_body images
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_body/0.png" alt="GIF 1" style="width:300px;height:300px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_body/89.png" alt="GIF 2" style="width:300px;height:300px;"></td>
    <td><img src="https://github.com/yqx7150/ALL-PET/blob/main/PET_body/97.png" alt="GIF 3" style="width:300px;height:300px;"></td>
  </tr>
  
</table>

## Other Related Projects

  * RAYSOLUTION_PETdata[<font size=5>**[Data]**</font>](https://github.com/yqx7150/RAYSOLUTION_PETdata)

